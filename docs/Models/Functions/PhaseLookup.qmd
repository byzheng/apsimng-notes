---
title: "PhaseLookup"
format: html
---


```{r setup, echo=FALSE}
setup_qmd()
```

PhaseLookup selects a value based on the current growth phase of the crop. It allows users to define different function values for different stages of development (e.g., vegetative, flowering, grain filling), and outputs the value corresponding to the current phase.


## Overview

This function is used to dynamically select a value during simulation depending on which growth phase the crop is currently in. It is typically used when a biological response or parameter changes depending on the stage of development.

For example, you may want thermal time accumulation, stress response, or nutrient demand to behave differently in vegetative versus reproductive phases. `PhaseLookup` works like a switch that returns the appropriate value based on which phase the crop is currently in.

## Model Structure

{{< include /_includes/Models/model-structure-intro.md >}}

This function inherits from the following parent classes:

* [Model](/docs/Models/Core/Model.qmd)
* [IFunction](/docs/APSIM.Core/IFunction.qmd)
* [IStructureDependency](/docs/APSIM.Core/IStructureDependency.qmd)


## Connections to Other Components

{{< include /_includes/Models/connections-intro.md >}}

| Component | Model | Connection Type | Description                                          |
|-----------|-------|-----------------|------------------------------------------------------|
| PhaseLookupValue | [PhaseLookupValue](/docs/Models/Functions/PhaseLookupValue.qmd) | Children | One or more child models, each defining a value for a specific phase range. |
| Phenology | [Phenology](/docs/Models/PMF/Phenology/Phenology.qmd) | Link (via children) | Provides current growth stage information to determine which phase is active. |


## Model Variables

{{< include /_includes/Models/model-variables-intro.md >}}


**Configurable and Reportable Properties**

> No configurable properties are available for this function.

**Read-Only Reportable Properties**



| Property             | Type    | Description                                                                 |
|----------------------|---------|-----------------------------------------------------------------------------|
| Value   | double  | The sum of values from all child functions.                      |



## Processes and Algorithms

{{< include /_includes/Models/processes-intro.md >}}


### Phase-Based Value Selection

The `PhaseLookup` function evaluates all its child `PhaseLookupValue` models in sequence. For each child:

1. Check if the crop is currently between the child's defined `Start` and `End` stages.
2. If yes, return the value from the first matching child and stop checking further.
3. If no phase matches any of the child `PhaseLookupValue` models, return 0 by default.

The logic can be expressed as:

$$
V = 
\begin{cases}
V_i & \text{if crop is in phase range } i \\
0 & \text{if no match}
\end{cases}
$$

where $V$ is the returned value and $V_i$ is the value from the $i$-th `PhaseLookupValue` child.

**Key Behavior:** The function returns the value from the **first** matching child and stops evaluation. This means the order of child `PhaseLookupValue` models matters if there are overlapping phase ranges.

Each `PhaseLookupValue` child defines:
- **Start phase name:** The beginning of the active phase range
- **End phase name:** The end of the active phase range
- **A value or function:** What to return during that phase range (defined as a child of the `PhaseLookupValue`)


## User Interface

`PhaseLookup` can be added as a child of any node in the model tree. Right-click the parent node, select "Add Model...", and search for `PhaseLookup` in the Filter Box. A symbol for the `PhaseLookup` is displayed in the user interface to represent the function.

![](https://github.com/APSIMInitiative/ApsimX/raw/master/ApsimNG/Resources/TreeViewImages/PhaseLookup.png){ width=64px }


## Practical Example

In a crop model, you may want a function to return a higher value during vegetative growth and a lower value during reproductive stages. You would use:

- `PhaseLookup` as the parent function.
- Two children of type `PhaseLookupValue`:
  - One active from `Emergence` to `FloralInitiation`, returning a value of 1.0
  - Another from `FloralInitiation` to `Maturity`, returning a value of 0.5

This setup allows the model to adjust behavior based on phase without writing additional logic elsewhere. For instance, this could be used to model radiation use efficiency that decreases after floral initiation, or nitrogen demand that varies between growth stages.


## See Also

* **Related Models:** [PhaseLookupValue](/docs/Models/Functions/PhaseLookupValue.qmd)
* **Source code:** [PhaseLookup.cs on GitHub](http://github.com/APSIMInitiative/ApsimX/blob/master/Models/Functions/PhaseLookup.cs)
