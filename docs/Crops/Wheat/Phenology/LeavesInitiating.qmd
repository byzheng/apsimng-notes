---
title: "LeavesInitiating"
output: html_document
draft: true
---


```{r setup, echo = FALSE}
setup_qmd()
```

```{r}
a <- 1

```

The **LeavesInitiating** phase in the [Wheat](/docs/Crops/Wheat) model represents the developmental period from **Emergence** to **DoubleRidge**, driven by the expression of the Vrn1, Vrn2, and Vrn3 genes. This phase concludes when vernalisation is saturated, as predicted by the [Cereal Anthesis Molecular Phenology](/docs/Models/PMF/Phenology/CAMP/index.qmd) (CAMP) model.


## Overview

The [VernalisationPhase](/docs/Models/PMF/Phenology/Phases/VernalisationPhase.qmd) Model is used to simulate the progress of vernalisation requirements. This phase begins when Plant `Emergence` to `DoubleRidge`.

## Methodology

See [VernalisationPhase](/docs/Models/PMF/Phenology/Phases/VernalisationPhase.qmd) and [CAMP](/docs/Models/PMF/Phenology/CAMP/index.qmd) model for details on how the vernalisation progress is calculated. Here is focusing on the parameters used in this phase, i.e. [CAMP](/docs/Models/PMF/Phenology/CAMP/index.qmd) with the following parameters:

* `TT`: Daily thermal time
* `HaunStage`: Haun stage is the number of leaves on the main stem
* `DeltaHaunStage`: Change in Haun stage from the previous day
* `BasePhyllochron`: Base phyllochron, the thermal time required for each new leaf to appear under standard conditions
* `PpResponse`: Photoperiod response for vernalisation

**Thermal Time (`TT`)**

The daily [thermal time](ThermalTime.qmd) is based on [SubDailyInterpolation](/docs/Models/Functions/SubDailyInterpolation.qmd) with three cardinal temperature and [ThreeHourAirTemperature](/docs/Models/Functions/ThreeHourAirTemperature.qmd) interpolation method.

**Haun Stage (`HaunStage`) and Delta Haun Stage (`DeltaHaunStage`)**

Haun Stage ($HS$) and $\Delta HS$ is calculated from daily [thermal time](ThermalTime.qmd) and a cultivar-specific [phyllochron](Phyllochron.qmd), which is the rate of leaf appearance.

**Base Phyllochron (`BasePhyllochron`)**

The base [phyllochron](Phyllochron.qmd) is defined as the thermal time required for each new leaf to appear under standard conditions with a default value of 120 °C·days.

**Photoperiod Response (`PpResponse`)**


```{r camp-pp-response, fig.height = 3, fig.cap="Leaf Stage Factor as a Function of Leaf Cohort Number"}
# Plot the leaf stage factor as a function of leaf cohort number
library(ggplot2)

x <- c(0, 8, 16, 24)
y <- c(0, 0, 1, 1)
x_out <- seq(0, 24)
df <- data.frame(day_length = x_out, f_d = weaana::interpolationFunction(x, y, values = x_out))

ggplot(df, aes(x = day_length)) +
    geom_line(aes(y = f_d)) +
    labs(
        x = "Day Length (hours)",
        y = "Modifier Value"
    ) +
    scale_x_continuous(breaks = x_out) +
    theme_minimal()
```


## Cultivar-Specific Parameters

| Name       | Description                                         | Default Value |
|------------|-----------------------------------------------------|---------------|
| [Phenology].Germinating.MinSoilTemperature.FixedValue   | Minimum soil temperature for germination (°C)      | 0.0           |

## Practical Example

> No practical example is provided for the thermal time function.

