<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CalcCAMPVrnRates – APSIM NG Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<link href="../../../../../images/icons/icon_192.png" rel="icon" type="image/png">
<script src="../../../../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../../../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap-fdf783755799cb83fdc553b0a9c5f906.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5K7WTC1T5R"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5K7WTC1T5R', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<style>
div.callout-needs-improvement.callout {
  border-left-color: #FFCC00;
}
div.callout-needs-improvement.callout-style-default > .callout-header {
  background-color: rgba(255, 204, 0, 0.13);
}
div.callout-needs-improvement .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-needs-improvement.callout-style-default .callout-icon::before, div.callout-needs-improvement.callout-titled .callout-icon::before {
  content: '⚠️';
  background-image: none;
}
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../../images/icons/icon.png" alt="APSIM Next Generation Icon" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">APSIM NG Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../../../docs/index.html" aria-current="page"> 
<span class="menu-text">Docs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../tips/index.html"> 
<span class="menu-text">Tips</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../disclaimer.html"> 
<span class="menu-text">Disclaimer</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/byzheng/apsimng-notes"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../docs/index.html">Docs</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/index.html">Models</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/PMF/index.html">PMF</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/PMF/Phenology/index.html">Phenology</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/PMF/Phenology/CAMP/index.html">CAMP</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/PMF/Phenology/CAMP/CalcCAMPVrnRates.html">CalcCAMPVrnRates</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Docs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/abbreviations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary of Abbreviations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Symbol Glossary</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Crops/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Crops</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Barley/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Barley</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Crops/Canola/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Canola</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Crops/Canola/Phenology/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phenology</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/EarlyFlowering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EarlyFlowering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/EarlyGrainFilling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EarlyGrainFilling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/EarlyPodDevelopment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EarlyPodDevelopment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/Emerging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Emerging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/Germinating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Germinating</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/LateGrainFilling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LateGrainFilling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/Maturing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maturing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/MidGrainFilling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MidGrainFilling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/ReadyForHarvesting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ReadyForHarvesting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/Ripening.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ripening</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/ThermalTime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Thermal Time</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Canola/Phenology/Vegetative.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vegetative</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Crops/Wheat/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wheat</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Examples</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Examples/wheat_example1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wheat Example Simulation 1</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Crops/Wheat/Phenology/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phenology</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/Emerging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Emerging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/Flowering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flowering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/Germinating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Germinating</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/GrainExpanding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GrainExpanding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/GrainFilling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GrainFilling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/GrainRipening.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GrainRipening</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/HaunStage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Haun Stage</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/Heading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Heading</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/LeavesInitiating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LeavesInitiating</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/Phyllochron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phyllochron</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/ReadyForHarvesting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ReadyForHarvesting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Phenology/ThermalTime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Thermal Time</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Crops/Wheat/Traits/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Traits</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/Traits/co2-wheat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CO2 for Wheat</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Crops/Wheat/grain/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grain</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Crops/Wheat/grain/NitrogenDemand.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grain Nitrogen Filling Rate or Nitrogen Demand (Wheat)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Models/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Clock.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clock</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Events.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Events</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Models/Functions/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Functions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/AccumulateFunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AccumulateFunction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/AddFunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AddFunction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/Constant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constant</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/DivideFunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DivideFunction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/HourlySinPpAdjusted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HourlySinPpAdjusted</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/MaximumFunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MaximumFunction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/MinimumFunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MinimumFunction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/MultiplyFunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MultiplyFunction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/PhaseLookup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PhaseLookup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/PhaseLookupValue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PhaseLookupValue</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/PhotoperiodFunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Photoperiod</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/SubDailyInterpolation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SubDailyInterpolation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/SubtractFunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SubtractFunction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/ThreeHourAirTemperature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ThreeHourAirTemperature</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/XYPairs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XYPairs Function</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">DemandFunctions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Functions/DemandFunctions/StorageNDemandFunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Daily Nitrogen Demand for Storage Organs</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Models/Graph/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graph</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Graph/EventNamesOnGraph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Show Event Names on Graph</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Models/PMF/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PMF</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Models/PMF/Arbitrator/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Arbitrator</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth4 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Arbitrator/NutrientConstrainedAllocationMethod.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nutrient Constrained Allocation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Arbitrator/RelativeAllocation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Relative Allocation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Models/PMF/Phenology/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phenology</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth4 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/Phenology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phenology</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Models/PMF/Phenology/CAMP/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAMP</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth5 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CalcCAMPVrnRates.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">CalcCAMPVrnRates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CAMP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CAMP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/CAMP/ColdVrnResponse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ColdVrnResponse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CultivarRateParams</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/CAMP/FinalLeafNumberSet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FinalLeafNumberSet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/CAMP/FLNParameterEnvironment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FLNParameterEnvironment</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Models/PMF/Phenology/Phases/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phases</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth5 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/Phases/EmergingPhase.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EmergingPhase</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/Phases/EndPhase.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EndPhase</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/Phases/GenericPhase.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GenericPhase</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/Phases/GerminatingPhase.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GerminatingPhase</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/Phases/IPhase.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IPhase</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/PMF/Phenology/Phases/VernalisationPhase.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">VernalisationPhase</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../../../docs/Models/Traits/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Traits</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/Models/Traits/CO2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CO2</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false">
 <span class="menu-text">Management</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../../../docs/management/fertiliser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fertiliser Types</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#inputs" id="toc-inputs" class="nav-link" data-scroll-target="#inputs">Inputs</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a></li>
  <li><a href="#events" id="toc-events" class="nav-link" data-scroll-target="#events">Events</a></li>
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties">Properties</a></li>
  <li><a href="#user-interface" id="toc-user-interface" class="nav-link" data-scroll-target="#user-interface">User Interface</a></li>
  <li><a href="#practical-example" id="toc-practical-example" class="nav-link" data-scroll-target="#practical-example">Practical Example</a></li>
  <li><a href="#see-also" id="toc-see-also" class="nav-link" data-scroll-target="#see-also">See Also</a></li>
  </ul>
<div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/byzheng/apsimng-notes/edit/main/docs/Models/PMF/Phenology/CAMP/CalcCAMPVrnRates.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/byzheng/apsimng-notes/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../../../docs/index.html">Docs</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/index.html">Models</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/PMF/index.html">PMF</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/PMF/Phenology/index.html">Phenology</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/PMF/Phenology/CAMP/index.html">CAMP</a></li><li class="breadcrumb-item"><a href="../../../../../docs/Models/PMF/Phenology/CAMP/CalcCAMPVrnRates.html">CalcCAMPVrnRates</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">CalcCAMPVrnRates</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>A function in APSIM Next Generation that calculates vernalisation (Vrn) expression rate parameters for a given genotype, using observed final leaf number (FLN) data and controlled environment parameters. It forms a core part of the CAMP (Cereal Apical Meristem Phenology) model and supports simulation of genotype-specific developmental responses to photoperiod and vernalisation cues.</p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p><code>CalcCAMPVrnRates</code> is used to derive the coefficients that govern how vernalisation and photoperiod affect the expression rates of vernalisation genes in the CAMP model. It operates on FLN observations from controlled environment studies with defined photoperiod and temperature treatments. The outputs are rate parameters that quantify the rate and phase transitions of Vrn expression in different photothermal regimes, enabling genotype-specific simulation of phenological development.</p>
<p>This function is critical for enabling APSIM NG to simulate genotype-by-environment interactions in crop phenology, particularly for cereal crops where vernalisation and photoperiod sensitivity genes such as Vrn1, Vrn2, and Vrn3 play a pivotal role.</p>
</section>
<section id="inputs" class="level2">
<h2 class="anchored" data-anchor-id="inputs">Inputs</h2>
<p>This function requires the following inputs:</p>
<ul>
<li><code>FinalLeafNumberSet FLNset</code>: A dataset containing FLN values under different photoperiod and vernalisation treatments:
<ul>
<li><code>LV</code> – Long photoperiod with vernalisation</li>
<li><code>LN</code> – Long photoperiod without vernalisation</li>
<li><code>SV</code> – Short photoperiod with vernalisation</li>
<li><code>SN</code> – Short photoperiod without vernalisation</li>
</ul></li>
<li><code>FLNParameterEnvironment EnvData</code>: The environmental parameters under which FLN was observed:
<ul>
<li><code>VrnTreatTemp</code>: Vernalisation treatment temperature (°C)</li>
<li><code>VrnTreatDuration</code>: Duration of vernalisation treatment (days)</li>
<li><code>TreatmentPp_L</code>: Long-day photoperiod (hours)</li>
<li><code>TtEmerge</code>: Thermal time from sowing to emergence (°Cd)</li>
</ul></li>
</ul>
<p>In addition, it links to:</p>
<ul>
<li><code>basePhyllochron</code>: A child model function that returns the phyllochron (thermal time per leaf)</li>
<li><code>camp</code>: The ancestor <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CAMP.html" class="model-link">CAMP</a> model, which provides helper methods and constants</li>
</ul>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<p>The <code>CalcCAMPVrnRates</code> function estimates <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">vernalisation rate parameters</a> using:</p>
<ul>
<li><code>FLNset</code>: a set of <a href="../../../../../docs/Models/PMF/Phenology/CAMP/FinalLeafNumberSet.html" class="model-link">final leaf number parameters</a></li>
<li><code>EnvData</code>: <a href="../../../../../docs/Models/PMF/Phenology/CAMP/FLNParameterEnvironment.html" class="model-link">controlled environment data</a> used to measure final leaf number</li>
</ul>
<p>The function performs the following steps:</p>
<ol type="1">
<li><a href="#emergence-duration" class="model-link">Convert Emergence Duration from Thermal Time to Phyllochrons</a><br>
</li>
<li><a href="#vern-phyllochron" class="model-link">Base phyllochron duration of vernalisation treatment</a><br>
</li>
<li><a href="#haun-ts" class="model-link">Estimate Haun Stage at Terminal Spikelet</a><br>
</li>
<li><a href="#min-vs" class="model-link">Calculate Minimum Vernalisation Saturation to Terminal Spikelet</a><br>
</li>
<li><a href="#vs-phyllochrons" class="model-link">Calculate the accumulated phyllochrons at vernalisation saturation for each treatment</a><br>
</li>
<li><a href="#vrn-rates" class="model-link">Calculate Vernalisation Rates and Photoperiod Sensitivities</a><br>
</li>
<li><a href="#vrn2-max" class="model-link">Calculate Maximum Vrn2 Expression Under Long Photoperiods</a><br>
</li>
<li><a href="#cold-vrn1" class="model-link">Calculate Cold-Induced Upregulation of Vrn1 Expression</a></li>
</ol>
<section id="emergence-duration" class="level3">
<h3 class="anchored" data-anchor-id="emergence-duration">Convert Emergence Duration from Thermal Time to Phyllochrons</h3>
<p>The duration from sowing to emergence is first expressed in phyllochrons (<span class="math inline">\(Ph_\text{emergence}\)</span>) using the base phyllochron value (<span class="math inline">\(Ph_\text{base}\)</span>):</p>
<p><span class="math display">\[
Ph_\text{emergence} = \frac{TT_\text{emergence}}{Ph_\text{base}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(TT_\text{emergence}\)</span> is the thermal time from sowing to emergence (°C·days), <code>TtEmerge</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/FLNParameterEnvironment.html" class="model-link">FLNParameterEnvironment.qmd</a>,</li>
<li><span class="math inline">\(Ph_\text{base}\)</span> is the base phyllochron duration.</li>
</ul>
</section>
<section id="vern-phyllochron" class="level3">
<h3 class="anchored" data-anchor-id="vern-phyllochron">Base phyllochron duration of vernalisation treatment</h3>
<p>The base phyllochron duration of the vernalisation treatment (<span class="math inline">\(Ph_\text{vern}\)</span>) is calculated as: <span class="math display">\[
Ph_\text{vern} = \frac{T_\text{vern} \times D_\text{V}}{Ph_\text{base}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(T_\text{vern}\)</span> is the vernalisation treatment temperature (°C), <code>VrnTreatTemp</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/FLNParameterEnvironment.html" class="model-link">FLNParameterEnvironment.qmd</a>,</li>
<li><span class="math inline">\(D_\text{V}\)</span> is the vernalisation treatment duration (days), <code>VrnTreatDuration</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/FLNParameterEnvironment.html" class="model-link">FLNParameterEnvironment.qmd</a>,</li>
<li><span class="math inline">\(Ph_\text{base}\)</span> is the base phyllochron duration.</li>
</ul>
</section>
<section id="haun-ts" class="level3">
<h3 class="anchored" data-anchor-id="haun-ts">Estimate Haun Stage at Terminal Spikelet</h3>
<p>The Haun Stage at terminal spikelet for each environment <span class="math inline">\(i\)</span> (e.g., LV, LN, SV, SN) is calculated following the method of <span class="citation" data-cites="brown_integration_2013">Brown et al. (<a href="#ref-brown_integration_2013" role="doc-biblioref">2013</a>)</span>:</p>
<p><span class="math display">\[
\text{HS}_{TS}(i) = \left( \text{FLN}(i) - 2.85 \right) \times 1.1
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{FLN}(i)\)</span> is the final leaf number observed under environment <span class="math inline">\(i\)</span>.</li>
</ul>
</section>
<section id="min-vs" class="level3">
<h3 class="anchored" data-anchor-id="min-vs">Calculate Minimum Vernalisation Saturation to Terminal Spikelet</h3>
<p>The minimum vernalisation saturation at terminal spikelet (<span class="math inline">\(\text{VS}_{TS,\ min}\)</span>) is estimated as:</p>
<p><span class="math display">\[
\text{VS}_{TS,\ min} = \min\left( \text{HS}_{TS,\ LV} - 1.1,\ 3 \right)
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{HS}_{TS,\ LV}\)</span> is the Haun Stage at terminal spikelet in the long-day vernalised (LV) treatment,</li>
<li>1.1 is the earliest Haun Stage at which vernalisation saturation can begin,</li>
<li>3 is the maximum stage for vernalisation saturation, based on Lincoln controlled environment data (CRWT153).</li>
</ul>
</section>
<section id="vs-phyllochrons" class="level3">
<h3 class="anchored" data-anchor-id="vs-phyllochrons">Calculate the accumulated phyllochrons at vernalisation saturation for each treatment</h3>
<p>The accumulated phyllochron at vernalisation saturation is estimated for each photoperiod × vernalisation treatment. These values are expressed in phyllochrons and are derived relative to the Haun Stage at terminal spikelet (<span class="math inline">\(\text{HS}_{TS}\)</span>) and the previously calculated minimum duration between vernalisation saturation and terminal spikelet (<span class="math inline">\(\text{VS}_{TS,\text{min}}\)</span>).</p>
<p><strong>Long-day Vernalised (LV) Environment</strong></p>
<p>For the LV treatment, vernalisation saturation is assumed to occur exactly <span class="math inline">\(\text{VS}_{TS,\text{min}}\)</span> before terminal spikelet:</p>
<p><span class="math display">\[
\text{VS}_{LV} = \text{HS}_{TS,\ LV} - \text{VS}_{TS,\text{min}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{HS}_{TS,\ LV}\)</span> is the Haun Stage at terminal spikelet for the LV treatment,</li>
<li><span class="math inline">\(\text{VS}_{TS,\text{min}}\)</span> is the minimum vernalisation saturation to terminal spikelet.</li>
</ul>
<p>This forms the baseline timing of saturation under conditions without vernalisation and photoperiod impacts.</p>
<p><strong>Long-day Non-vernalised (LN) Environment</strong></p>
<p>For LN, the vernalisation saturation timing is constrained by Haun Stage of LN at terminal spikelet (<span class="math inline">\(\text{HS}_{TS,\ LN}\)</span>) and cannot occur earlier than in the LV treatment:</p>
<p><span class="math display">\[
\text{VS}_{LN} = \max(\text{HS}_{TS,\ LN} - \text{VS}_{TS,\text{min}},\ \text{VS}_{LV})
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{HS}_{TS,\ LN}\)</span> is the Haun Stage at terminal spikelet for the LN treatment,</li>
<li><span class="math inline">\(\text{VS}_{LV}\)</span> is the vernalisation saturation timing for the LV treatment,</li>
<li><span class="math inline">\(\text{VS}_{TS,\text{min}}\)</span> is the minimum vernalisation saturation to terminal spikelet.</li>
</ul>
<p>This ensures the LN environment does not reach vernalisation saturation before LV.</p>
<p><strong>Short-day Vernalised (SV) Environment</strong></p>
<p>For the SV treatment, the vernalisation saturation timing is constrained by Haun Stage of LN at terminal spikelet (<span class="math inline">\(\text{HS}_{TS,\ SV}\)</span>) and cannot occur earlier than in the LV treatment:</p>
<p><span class="math display">\[
\text{VS}_{SV} = \max(\text{HS}_{TS,\ SV} - \text{VS}_{TS,\text{min}},\ \text{VS}_{LV})
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{HS}_{TS,\ SV}\)</span> is the Haun Stage at terminal spikelet for the SV treatment,</li>
<li><span class="math inline">\(\text{VS}_{LV}\)</span> is the vernalisation saturation timing for the LV treatment,</li>
<li><span class="math inline">\(\text{VS}_{TS,\text{min}}\)</span> is the minimum vernalisation saturation to terminal spikelet.</li>
</ul>
<p>This ensures the SV environment does not reach vernalisation saturation before LV.</p>
<p><strong>Short-day Non-vernalised (SN) Environment</strong></p>
<p>For the SN environment, saturation is constrained by Haun Stage of LN at terminal spikelet (<span class="math inline">\(\text{HS}_{TS,\ SN}\)</span>) and cannot occur earlier than in the LV treatment:</p>
<p><span class="math display">\[
\text{VS}_{SN} = \max(\text{HS}_{TS,\ SN} - \left( \text{HS}_{TS,\ SV} - \text{VS}_{SV} \right),\ \text{VS}_{LV})
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{HS}_{TS,\ SN}\)</span> is the Haun Stage at terminal spikelet for the SN treatment,</li>
<li><span class="math inline">\(\text{HS}_{TS,\ SV}\)</span> is the Haun Stage at terminal spikelet for the SV treatment,</li>
<li><span class="math inline">\(\text{VS}_{SV}\)</span> is the vernalisation saturation timing for the SV treatment,</li>
<li><span class="math inline">\(\text{VS}_{LV}\)</span> is the vernalisation saturation timing for the LV treatment.</li>
</ul>
<p>This ensures the SV environment does not reach vernalisation saturation before LV.</p>
</section>
<section id="vrn-rates" class="level3">
<h3 class="anchored" data-anchor-id="vrn-rates">Calculate Vernalisation Rates and Photoperiod Sensitivities</h3>
<p>The base and maximum rates of vernalisation progression during the vegetative and early reproductive phases are estimated, along with the photoperiod (Pp) sensitivity factors.</p>
<p><strong>Base Vernalisation Rate During Vegetative Phase</strong></p>
<p>Base vernalisation rate during vegetative phase (<span class="math inline">\(\Delta V_{\text{base, veg}}\)</span>, <code>BaseDVrnVeg</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) assumes vernalisation starts at sowing and proceeds linearly until saturation in the SN treatment (which is short-day and non-vernalised treatment and lacks vernalising temperature and long photoperiod upregulation), the base rate is:</p>
<p><span class="math display">\[
\Delta V_{\text{base, veg}} = \frac{1}{\text{VS}_{SN} + Ph_{\text{emergence}}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{VS}_{SN}\)</span> is the phyllochron at vernalisation saturation for the SN treatment,</li>
<li><span class="math inline">\(Ph_{\text{emergence}}\)</span> is the phyllochron duration from sowing to emergence.</li>
</ul>
<p><strong>Maximum Vernalisation Rate During Vegetative Phase</strong></p>
<p>The fastest rate of vernalisation during vegetative phase (<span class="math inline">\(\Delta V_{\text{max, veg}}\)</span>, <code>MaxDVrnVeg</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) is assumed to occur in the SV treatment (i.e.&nbsp;short-day with vernalisation), where the rate is maximised at the minimum vernalisation saturation to terminal spikelet:</p>
<p><span class="math display">\[
\Delta V_{\text{max, veg}} = \frac{1}{\text{VS}_{SV} + Ph_{\text{emergence}}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{VS}_{SV}\)</span> is the phyllochron at vernalisation saturation for the SV treatment,</li>
<li><span class="math inline">\(Ph_{\text{emergence}}\)</span> is the phyllochron duration from sowing to emergence.</li>
</ul>
<p><strong>Base Vernalisation Rate During Early Reproductive Phase</strong></p>
<p>The base vernalisation rate during early reproductive phase (<span class="math inline">\(\Delta V_{\text{base, ER}}\)</span>, <code>BaseDVrnER</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) is calculated as:</p>
<p><span class="math display">\[
\Delta V_{\text{base, ER}} = \frac{1}{\text{HS}_{TS,\ SN} - \text{VS}_{SN}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{HS}_{TS,\ SN}\)</span> is the Haun Stage at terminal spikelet for the SN treatment,</li>
<li><span class="math inline">\(\text{VS}_{SN}\)</span> is the phyllochron at vernalisation saturation for the SN treatment.</li>
</ul>
<p><strong>Maximum Vernalisation Rate During Early Reproductive Phase</strong></p>
<p>The maximum vernalisation rate during early reproductive phase (<span class="math inline">\(\Delta V_{\text{max, ER}}\)</span>, <code>MaxDVrnER</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) is calculated as:</p>
<p><span class="math display">\[
\Delta V_{\text{max, ER}} = \frac{1}{\text{VS}_{TS,\ min}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{VS}_{TS,\ min}\)</span> is the minimum vernalisation saturation to terminal spikelet, calculated earlier.</li>
</ul>
<p><strong>Photoperiod Sensitivity Factor During Early Reproductive Phase</strong></p>
<p>The photoperiod sensitivity factor during early reproductive phase (<span class="math inline">\(F_{\text{Pp, Vrn3, ER}}\)</span>, <code>PpVrn3FactER</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) is calculated as: <span class="math display">\[
F_{\text{Pp, Vrn3, ER}} = \left( \frac{\Delta V_{\text{max, ER}}}{\Delta V_{\text{base, ER}}} - 1 \right) + 1
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\Delta V_{\text{max, ER}}\)</span> is the maximum vernalisation rate during early reproductive phase,</li>
<li><span class="math inline">\(\Delta V_{\text{base, ER}}\)</span> is the base vernalisation rate during early reproductive phase.</li>
</ul>
<p>This factor quantifies how much faster vernalisation proceeds under long photoperiod compared to the baseline.</p>
<p><strong>Photoperiod Sensitivity Factor During Vegetative Phase</strong></p>
<p>The photoperiod sensitivity factor during vegetative phase (<span class="math inline">\(F_{\text{Pp, Vrn3, veg}}\)</span>, <code>PpVrn3FactVeg</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) is calculated as: <span class="math display">\[
F_{\text{Pp, Vrn3, veg}} = \left( \frac{1 / \text{VS}_{LN}}{\Delta V_{\text{max, veg}}} - 1 \right) + 1
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{VS}_{LN}\)</span> is the phyllochron at vernalisation saturation for the LN treatment,</li>
<li><span class="math inline">\(\Delta V_{\text{max, veg}}\)</span> is the maximum vernalisation rate during vegetative phase.</li>
</ul>
<p>To ensure consistency, this factor is constrained to be no less than the early reproductive sensitivity:</p>
<p><span class="math display">\[
F_{\text{Pp, Vrn3, veg}} = \max(F_{\text{Pp, Vrn3, veg}},\ F_{\text{Pp, Vrn3, ER}})
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(F_{\text{Pp, Vrn3, veg}}\)</span> is the photoperiod sensitivity factor during vegetative phase,</li>
<li><span class="math inline">\(F_{\text{Pp, Vrn3, ER}}\)</span> is the photoperiod sensitivity factor during early reproductive phase.</li>
</ul>
</section>
<section id="vrn2-max" class="level3">
<h3 class="anchored" data-anchor-id="vrn2-max">Calculate Maximum Vrn2 Expression Under Long Photoperiods</h3>
<p>The maximum vernalisation repressor (Vrn2) expression under long photoperiod conditions without vernalising temperatures (<span class="math inline">\(V_{\text{max, Vrn2}}\)</span>, , <code>MaxVrn2</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) is estimated as:</p>
<p>Before vernalisation saturation (VS) is reached under long photoperiod without vernalisation, Vrn1 expression is influenced by both baseline and Vrn3-induced pathways. The effective rate of Vrn1 expression is:</p>
<p><span class="math display">\[
\Delta V_{\text{Vrn1} \times \text{Vrn3}} = \max\left( \frac{1}{VS_{\text{LN}}},\ \Delta V_{\text{base, veg}} \times F_{\text{Pp, Vrn3, veg}} \right)
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\frac{1}{VS_{\text{LN}}}\)</span> is the rate assuming linear accumulation from sowing to saturation without upregulation,</li>
<li><span class="math inline">\(\Delta V_{\text{base, veg}}\)</span> is the base Vrn1 rate,</li>
<li><span class="math inline">\(F_{\text{Pp, Vrn3, veg}}\)</span> is the photoperiod (Vrn3) sensitivity factor in the vegetative phase.</li>
</ul>
<p><strong>Duration of Effective Vrn1 × Vrn3 Expression Phase</strong></p>
<p>The time (in Haun stages) needed to reach saturation at the above rate is:</p>
<p><span class="math display">\[
H_{\text{Vrn1} \times \text{Vrn3}} = \frac{1}{\Delta V_{\text{Vrn1} \times \text{Vrn3}}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\Delta V_{\text{Vrn1} \times \text{Vrn3}}\)</span> is the effective rate of Vrn1 × Vrn3 expression,</li>
<li><span class="math inline">\(H_{\text{Vrn1} \times \text{Vrn3}}\)</span> is the duration of effective Vrn1 × Vrn3 expression in Haun stages.</li>
</ul>
<p>This represents the duration over which the effective Vrn1 × Vrn3 expression occurs in the absence of vernalisation.</p>
<p><strong>Haun Stage When Vrn2 Expression Ends</strong></p>
<p>Vrn2 expression is assumed to end just before Vrn1 × Vrn3 takes effect. This occurs <span class="math inline">\(H_{\text{Vrn1} \times \text{Vrn3}}\)</span> stages prior to saturation:</p>
<p><span class="math display">\[
\text{EndVrn2}_{\text{LN}} = \max\left(0,\ VS_{\text{LN}} - H_{\text{Vrn1} \times \text{Vrn3}} \right)
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{EndVrn2}_{\text{LN}}\)</span> is the Haun stage when Vrn2 expression ends in the LN treatment,</li>
<li><span class="math inline">\(VS_{\text{LN}}\)</span> is the phyllochron at vernalisation saturation for the LN treatment,</li>
<li><span class="math inline">\(H_{\text{Vrn1} \times \text{Vrn3}}\)</span> is the duration of effective Vrn1 × Vrn3 expression in Haun stages.</li>
</ul>
<p>This value is constrained to be non-negative.</p>
<p><strong>Maximum Vrn2 Expression Under Long Photoperiods</strong></p>
<p>The total Vrn2 expression is assumed to accumulate linearly from emergence to the end of Vrn2 activity under baseline Vrn1 expression:</p>
<p><span class="math display">\[
V_{\text{max, Vrn2}} = \left( \text{EndVrn2}_{\text{LN}} + Ph_{\text{emergence}} \right) \times \Delta V_{\text{base, veg}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{EndVrn2}_{\text{LN}}\)</span> is the Haun stage when Vrn2 expression ends in the LN treatment,</li>
<li><span class="math inline">\(Ph_{\text{emergence}}\)</span> is the phyllochron duration from sowing to emergence,</li>
<li><span class="math inline">\(\Delta V_{\text{base, veg}}\)</span> is the base Vrn1 expression rate during the vegetative phase.</li>
</ul>
<p>This value represents the maximum repressive effect of Vrn2 that must be overcome before Vrn3-mediated acceleration of Vrn1 expression can begin.</p>
</section>
<section id="cold-vrn1" class="level3">
<h3 class="anchored" data-anchor-id="cold-vrn1">Calculate Cold-Induced Upregulation of Vrn1 Expression</h3>
<p>The effect of cold treatment on persistent (methylated) upregulation of <strong>Vrn1</strong> expression in the <strong>LV</strong> (long photoperiod + vernalisation) environment (<span class="math display">\[C_{\text{Vrn1}}\]</span>, <code>ColdVrn1Fact</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) is estimated as:</p>
<p><strong>Baseline Vrn1 Expression up to VS in the LV Treatment</strong></p>
<p>The total amount of Vrn1 expressed under baseline conditions in the LV treatment from sowing to vernalisation saturation is:</p>
<p><span class="math display">\[
V_{\text{base, LV}} = (Ph_\text{emergence} + VS_{\text{LV}}) \times \Delta V_{\text{base, veg}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Ph_\text{emergence}\)</span> is the phyllochron duration from sowing to emergence,</li>
<li><span class="math inline">\(VS_{\text{LV}}\)</span> is the phyllochron at vernalisation saturation for the LV treatment,</li>
<li><span class="math inline">\(\Delta V_{\text{base, veg}}\)</span> is the baseline rate of Vrn1 expression during the vegetative phase.</li>
</ul>
<p>This reflects the cumulative Vrn1 expression in the absence of cold-specific upregulation.</p>
<p><strong>Amount of Cold-Induced Persistent Vrn1 Expression</strong></p>
<p>Cold upregulation of Vrn1 (assumed to lead to methylation and memory) is calculated as:</p>
<p><span class="math display">\[
V_{\text{cold, LV}} = V_{\text{threshold}} + V_{\text{max, Vrn2}} - V_{\text{base, LV}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(V_{\text{threshold}}\)</span> is the saturation threshold for Vrn1 (typically 1),</li>
<li><span class="math inline">\(V_{\text{max, Vrn2}}\)</span> is the maximum Vrn2 repressive expression,</li>
<li><span class="math inline">\(V_{\text{base, LV}}\)</span> is the amount of Vrn1 expressed at baseline up to VS.</li>
</ul>
<p><strong>Methylation Threshold</strong></p>
<p>The methylation threshold (<span class="math inline">\(\theta_{\text{meth}}\)</span>, <code>MethalationThreshold</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) (i.e., amount of Vrn1 needed for full persistent response) is assumed to be equal to the cold-induced Vrn1 amount:</p>
<p><span class="math display">\[
\theta_{\text{meth}} = V_{\text{cold, LV}}
\]</span></p>
<p>This assumption is based on findings by Brooking and Jamieson that the lag before methylation equals the duration of vernalisation response.</p>
<p><strong>Effective Duration of Vernalisation</strong></p>
<p>The duration (in Haun stages) over which vernalisation is active is:</p>
<p><span class="math display">\[
H_{\text{vern, LV}} = \min(Ph_\text{vern},\ Ph_\text{emergence} + VS_{\text{LV}})
\]</span></p>
<p>Where: - <span class="math inline">\(Ph_\text{vern}\)</span> is the phyllochron duration of the vernalisation treatment, - <span class="math inline">\(Ph_\text{emergence}\)</span> is the phyllochron duration from sowing to emergence, - <span class="math inline">\(VS_{\text{LV}}\)</span> is the phyllochron at vernalisation saturation for the LV treatment.</p>
<p><strong>Cold-Induced Vrn1 Expression Rate During Treatment</strong></p>
<p>The total rate of Vrn1 expression under cold treatment is:</p>
<p><span class="math display">\[
\Delta V_{\text{cold, LV}} = \frac{V_{\text{cold, LV}} + \theta_{\text{meth}}}{H_{\text{vern, LV}}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(V_{\text{cold, LV}}\)</span> is the amount of cold-induced Vrn1 expression,</li>
<li><span class="math inline">\(\theta_{\text{meth}}\)</span> is the methylation threshold,</li>
<li><span class="math inline">\(H_{\text{vern, LV}}\)</span> is the effective duration of vernalisation in Haun stages.</li>
</ul>
<p><strong>Maximum Cold-Induced Expression Rate at 0°C</strong></p>
<p>Assuming an exponential temperature effect, the maximum rate of Vrn1 expression under cold is:</p>
<p><span class="math display">\[
\Delta V_{\text{cold, max}} = \frac{\Delta V_{\text{cold, LV}}}{\exp(k \cdot T_{\text{cold}})}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\Delta V_{\text{cold, LV}}\)</span> is the cold-induced Vrn1 expression rate during the vernalisation treatment,</li>
<li><span class="math inline">\(k\)</span> is the temperature coefficient for vernalisation (typically -0.17),</li>
<li><span class="math inline">\(T_{\text{cold}}\)</span> is the vernalisation treatment temperature, <code>VrnTreatTemp</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/FLNParameterEnvironment.html" class="model-link">FLNParameterEnvironment</a>.</li>
</ul>
<p><strong>Cold-Induced Vrn1 Upregulation Factor</strong></p>
<p>The cold upregulation factor (<span class="math inline">\(F_{\text{cold, vrn1}}\)</span>, <code>ColdVrn1Fact</code> in <a href="../../../../../docs/Models/PMF/Phenology/CAMP/CultivarRateParams.html" class="model-link">CultivarRateParams</a>) is calculated as the ratio of cold-enhanced Vrn1 expression to baseline expression:</p>
<p><span class="math display">\[
F_{\text{cold, vrn1}} = \frac{\Delta V_{\text{cold, max}}}{\Delta V_{\text{base, veg}}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\Delta V_{\text{cold, max}}\)</span> is the maximum cold-induced Vrn1 expression rate at 0°C,</li>
<li><span class="math inline">\(\Delta V_{\text{base, veg}}\)</span> is the baseline Vrn1 expression rate during the vegetative phase.</li>
</ul>
<p>This factor quantifies the enhancement in Vrn1 expression due to cold during vernalisation.</p>
</section>
</section>
<section id="events" class="level2">
<h2 class="anchored" data-anchor-id="events">Events</h2>
<p><strong>Events Listened For</strong></p>
<blockquote class="blockquote">
<p>No events are listened by this function.</p>
</blockquote>
<p><strong>Events Raised to</strong></p>
<blockquote class="blockquote">
<p>No events are raised by this function.</p>
</blockquote>
</section>
<section id="properties" class="level2">
<h2 class="anchored" data-anchor-id="properties">Properties</h2>
<p><strong>Configurable and Reportable Properties</strong></p>
<blockquote class="blockquote">
<p>No configurable properties are available for this function.</p>
</blockquote>
<p><strong>Read-Only Reportable Properties</strong></p>
<blockquote class="blockquote">
<p>No read-only properties are available for this function.</p>
</blockquote>
</section>
<section id="user-interface" class="level2">
<h2 class="anchored" data-anchor-id="user-interface">User Interface</h2>
<blockquote class="blockquote">
<p>Not typically user-configurable through the UI. It is populated by the <code>CalcCAMPVrnRates</code> function based on genotype-specific FLN observations.</p>
</blockquote>
</section>
<section id="practical-example" class="level2">
<h2 class="anchored" data-anchor-id="practical-example">Practical Example</h2>
<p>This example walks through each calculation step using the provided parameter values for very quick maturity <code>Emu_Rock</code> and very late maturity <code>Sunlamb</code> <span class="citation" data-cites="celestina_cultivar_2023">(<a href="#ref-celestina_cultivar_2023" role="doc-biblioref">Celestina et al. 2023</a>)</span>, resulting in all the key parameters for <code>CultivarRateParams</code>.</p>
<p>The following table summarises the parameters used APSIM Wheat Model for the two cultivars:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 72%">
<col style="width: 14%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter (Model Name)</th>
<th>Emu_Rock</th>
<th>Sunlamb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[Phenology].CAMP.FLNparams.MinLN</td>
<td>7.0</td>
<td>8.0</td>
</tr>
<tr class="even">
<td>[Phenology].CAMP.FLNparams.PpLN</td>
<td>9.0</td>
<td>12.0</td>
</tr>
<tr class="odd">
<td>[Phenology].CAMP.FLNparams.VrnLN</td>
<td>8.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td>[Phenology].CAMP.FLNparams.VxPLN</td>
<td>10.0</td>
<td>14.0</td>
</tr>
<tr class="odd">
<td>[Phenology].Phyllochron.BasePhyllochron.FixedValue</td>
<td>94.78</td>
<td>100.38</td>
</tr>
<tr class="even">
<td>[Phenology].CAMP.EnvData.VrnTreatTemp</td>
<td>5.8</td>
<td>5.8</td>
</tr>
<tr class="odd">
<td>[Phenology].CAMP.EnvData.VrnTreatDuration</td>
<td>60</td>
<td>60</td>
</tr>
<tr class="even">
<td>[Phenology].CAMP.EnvData.TreatmentPp_L</td>
<td>16</td>
<td>16</td>
</tr>
<tr class="odd">
<td>[Phenology].CAMP.EnvData.TtEmerge</td>
<td>90</td>
<td>90</td>
</tr>
</tbody>
</table>
<section id="convert-emergence-duration-from-thermal-time-to-phyllochrons" class="level4">
<h4 class="anchored" data-anchor-id="convert-emergence-duration-from-thermal-time-to-phyllochrons">1. Convert Emergence Duration from Thermal Time to Phyllochrons</h4>
<p><span class="math display">\[
Ph_\text{emergence} = \frac{TT_\text{emergence}}{Ph_\text{base}}
\]</span></p>
<ul>
<li>Emu_Rock: 90 / 94.78 ≈ 0.95</li>
<li>Sunlamb: 90 / 100.38 ≈ 0.90</li>
</ul>
</section>
<section id="base-phyllochron-duration-of-vernalisation-treatment" class="level4">
<h4 class="anchored" data-anchor-id="base-phyllochron-duration-of-vernalisation-treatment">2. Base phyllochron duration of vernalisation treatment</h4>
<p><span class="math display">\[
Ph_\text{vern} = \frac{T_\text{vern} \times D_\text{V}}{Ph_\text{base}}
\]</span></p>
<ul>
<li>Emu_Rock: (5.8 × 60) / 94.78 ≈ 3.67</li>
<li>Sunlamb: (5.8 × 60) / 100.38 ≈ 3.47</li>
</ul>
</section>
<section id="estimate-haun-stage-at-terminal-spikelet" class="level4">
<h4 class="anchored" data-anchor-id="estimate-haun-stage-at-terminal-spikelet">3. Estimate Haun Stage at Terminal Spikelet</h4>
<p><span class="math display">\[
\text{HS}_{TS}(i) = (\text{FLN}(i) - 2.85) \times 1.1
\]</span></p>
<ul>
<li>Emu_Rock:
<ul>
<li>LV: (7.0 - 2.85) × 1.1 = 4.15 × 1.1 ≈ 4.57</li>
<li>LN: (9.0 - 2.85) × 1.1 = 6.15 × 1.1 ≈ 6.77</li>
<li>SV: (8.0 - 2.85) × 1.1 = 5.15 × 1.1 ≈ 5.67</li>
<li>SN: (10.0 - 2.85) × 1.1 = 7.15 × 1.1 ≈ 7.87</li>
</ul></li>
<li>Sunlamb:
<ul>
<li>LV: (8.0 - 2.85) × 1.1 = 5.15 × 1.1 ≈ 5.67</li>
<li>LN: (12.0 - 2.85) × 1.1 = 9.15 × 1.1 ≈ 10.07</li>
<li>SV: (10.0 - 2.85) × 1.1 = 7.15 × 1.1 ≈ 7.87</li>
<li>SN: (14.0 - 2.85) × 1.1 = 11.15 × 1.1 ≈ 12.27</li>
</ul></li>
</ul>
</section>
<section id="calculate-minimum-vernalisation-saturation-to-terminal-spikelet" class="level4">
<h4 class="anchored" data-anchor-id="calculate-minimum-vernalisation-saturation-to-terminal-spikelet">4. Calculate Minimum Vernalisation Saturation to Terminal Spikelet</h4>
<p><span class="math display">\[
\text{VS}_{TS,\ min} = \min(\text{HS}_{TS,\ LV} - 1.1,\ 3)
\]</span></p>
<ul>
<li>Emu_Rock: min(4.57 - 1.1, 3) = min(3.47, 3) = 3.0</li>
<li>Sunlamb: min(5.67 - 1.1, 3) = min(4.57, 3) = 3.0</li>
</ul>
</section>
<section id="calculate-the-accumulated-phyllochrons-at-vernalisation-saturation-for-each-treatment" class="level4">
<h4 class="anchored" data-anchor-id="calculate-the-accumulated-phyllochrons-at-vernalisation-saturation-for-each-treatment">5. Calculate the accumulated phyllochrons at vernalisation saturation for each treatment</h4>
<ul>
<li><strong>LV:</strong> <span class="math inline">\(\text{VS}_{LV} = \text{HS}_{TS,\ LV} - \text{VS}_{TS,\ min}\)</span>
<ul>
<li>Emu_Rock: 4.57 - 3.0 = 1.57</li>
<li>Sunlamb: 5.67 - 3.0 = 2.67</li>
</ul></li>
<li><strong>LN:</strong> <span class="math inline">\(\text{VS}_{LN} = \max(\text{HS}_{TS,\ LN} - \text{VS}_{TS,\ min},\ \text{VS}_{LV})\)</span>
<ul>
<li>Emu_Rock: max(6.77 - 3.0, 1.57) = max(3.77, 1.57) = 3.77</li>
<li>Sunlamb: max(10.07 - 3.0, 2.67) = max(7.07, 2.67) = 7.07</li>
</ul></li>
<li><strong>SV:</strong> <span class="math inline">\(\text{VS}_{SV} = \max(\text{HS}_{TS,\ SV} - \text{VS}_{TS,\ min},\ \text{VS}_{LV})\)</span>
<ul>
<li>Emu_Rock: max(5.67 - 3.0, 1.57) = max(2.67, 1.57) = 2.67</li>
<li>Sunlamb: max(7.87 - 3.0, 2.67) = max(4.87, 2.67) = 4.87</li>
</ul></li>
<li><strong>SN:</strong> <span class="math inline">\(\text{VS}_{SN} = \max(\text{HS}_{TS,\ SN} - (\text{HS}_{TS,\ SV} - \text{VS}_{SV}),\ \text{VS}_{LV})\)</span>
<ul>
<li>Emu_Rock: max(7.87 - (5.67 - 2.67), 1.57) = max(7.87 - 3.0, 1.57) = max(4.87, 1.57) = 4.87</li>
<li>Sunlamb: max(12.27 - (7.87 - 4.87), 2.67) = max(12.27 - 3.0, 2.67) = max(9.27, 2.67) = 9.27</li>
</ul></li>
</ul>
</section>
<section id="calculate-vernalisation-rates-and-photoperiod-sensitivities" class="level4">
<h4 class="anchored" data-anchor-id="calculate-vernalisation-rates-and-photoperiod-sensitivities">6. Calculate Vernalisation Rates and Photoperiod Sensitivities</h4>
<ul>
<li><strong>Base Vernalisation Rate (Veg):</strong> <span class="math inline">\(\Delta V_{\text{base, veg}} = 1 / (\text{VS}_{SN} + Ph_\text{emergence})\)</span>
<ul>
<li>Emu_Rock: 1 / (4.87 + 0.95) = 1 / 5.82 ≈ 0.172</li>
<li>Sunlamb: 1 / (9.27 + 0.90) = 1 / 10.17 ≈ 0.098</li>
</ul></li>
<li><strong>Max Vernalisation Rate (Veg):</strong> <span class="math inline">\(\Delta V_{\text{max, veg}} = 1 / (\text{VS}_{SV} + Ph_\text{emergence})\)</span>
<ul>
<li>Emu_Rock: 1 / (2.67 + 0.95) = 1 / 3.62 ≈ 0.276</li>
<li>Sunlamb: 1 / (4.87 + 0.90) = 1 / 5.77 ≈ 0.173</li>
</ul></li>
<li><strong>Base Vernalisation Rate (ER):</strong> <span class="math inline">\(\Delta V_{\text{base, ER}} = 1 / (\text{HS}_{TS,\ SN} - \text{VS}_{SN})\)</span>
<ul>
<li>Emu_Rock: 1 / (7.87 - 4.87) = 1 / 3.0 ≈ 0.333</li>
<li>Sunlamb: 1 / (12.27 - 9.27) = 1 / 3.0 ≈ 0.333</li>
</ul></li>
<li><strong>Max Vernalisation Rate (ER):</strong> <span class="math inline">\(\Delta V_{\text{max, ER}} = 1 / \text{VS}_{TS,\ min}\)</span>
<ul>
<li>Both: 1 / 3.0 ≈ 0.333</li>
</ul></li>
<li><strong>Photoperiod Sensitivity (ER):</strong> <span class="math inline">\(F_{\text{Pp, Vrn3, ER}} = (\Delta V_{\text{max, ER}} / \Delta V_{\text{base, ER}} - 1) + 1\)</span>
<ul>
<li>Both: (0.333 / 0.333 - 1) + 1 = (1 - 1) + 1 = 1</li>
</ul></li>
<li><strong>Photoperiod Sensitivity (Veg):</strong> <span class="math inline">\(F_{\text{Pp, Vrn3, veg}} = (1 / \text{VS}_{LN} / \Delta V_{\text{max, veg}} - 1) + 1\)</span>
<ul>
<li>Emu_Rock: (1 / 3.77 / 0.276 - 1) + 1 = (0.265 / 0.276 - 1) + 1 ≈ (0.960 - 1) + 1 ≈ 0.960</li>
<li>Sunlamb: (1 / 7.07 / 0.173 - 1) + 1 = (0.141 / 0.173 - 1) + 1 ≈ (0.815 - 1) + 1 ≈ 0.815</li>
</ul>
Constrain to at least <span class="math inline">\(F_{\text{Pp, Vrn3, ER}}\)</span> (which is 1):
<ul>
<li>Emu_Rock: max(0.960, 1) = 1</li>
<li>Sunlamb: max(0.815, 1) = 1</li>
</ul></li>
</ul>
</section>
<section id="calculate-maximum-vrn2-expression-under-long-photoperiods" class="level4">
<h4 class="anchored" data-anchor-id="calculate-maximum-vrn2-expression-under-long-photoperiods">7. Calculate Maximum Vrn2 Expression Under Long Photoperiods</h4>
<ul>
<li><strong>Effective Vrn1 × Vrn3 Rate:</strong> <span class="math inline">\(\Delta V_{\text{Vrn1} \times \text{Vrn3}} = \max(1 / VS_{LN}, \Delta V_{\text{base, veg}} \times F_{\text{Pp, Vrn3, veg}})\)</span>
<ul>
<li>Emu_Rock: max(1 / 3.77, 0.172 × 1) = max(0.265, 0.172) = 0.265</li>
<li>Sunlamb: max(1 / 7.07, 0.098 × 1) = max(0.141, 0.098) = 0.141</li>
</ul></li>
<li><strong>Duration of Vrn1 × Vrn3 Expression:</strong> <span class="math inline">\(H_{\text{Vrn1} \times \text{Vrn3}} = 1 / \Delta V_{\text{Vrn1} \times \text{Vrn3}}\)</span>
<ul>
<li>Emu_Rock: 1 / 0.265 ≈ 3.77</li>
<li>Sunlamb: 1 / 0.141 ≈ 7.07</li>
</ul></li>
<li><strong>EndVrn2 (LN):</strong> <span class="math inline">\(\text{EndVrn2}_{\text{LN}} = \max(0, VS_{LN} - H_{\text{Vrn1} \times \text{Vrn3}})\)</span>
<ul>
<li>Emu_Rock: max(0, 3.77 - 3.77) = 0</li>
<li>Sunlamb: max(0, 7.07 - 7.07) = 0</li>
</ul></li>
<li><strong>MaxVrn2:</strong> <span class="math inline">\(V_{\text{max, Vrn2}} = (\text{EndVrn2}_{\text{LN}} + Ph_\text{emergence}) \times \Delta V_{\text{base, veg}}\)</span>
<ul>
<li>Emu_Rock: (0 + 0.95) × 0.172 ≈ 0.164</li>
<li>Sunlamb: (0 + 0.90) × 0.098 ≈ 0.088</li>
</ul></li>
</ul>
</section>
<section id="calculate-cold-induced-upregulation-of-vrn1-expression" class="level4">
<h4 class="anchored" data-anchor-id="calculate-cold-induced-upregulation-of-vrn1-expression">8. Calculate Cold-Induced Upregulation of Vrn1 Expression</h4>
<ul>
<li><strong>Baseline Vrn1 Expression up to VS in LV:</strong> <span class="math inline">\(V_{\text{base, LV}} = (Ph_\text{emergence} + VS_{LV}) \times \Delta V_{\text{base, veg}}\)</span>
<ul>
<li>Emu_Rock: (0.95 + 1.57) × 0.172 = 2.52 × 0.172 ≈ 0.433</li>
<li>Sunlamb: (0.90 + 2.67) × 0.098 = 3.57 × 0.098 ≈ 0.350</li>
</ul></li>
<li><strong>Cold-induced Vrn1:</strong> <span class="math inline">\(V_{\text{cold, LV}} = 1 + V_{\text{max, Vrn2}} - V_{\text{base, LV}}\)</span>
<ul>
<li>Emu_Rock: 1 + 0.164 - 0.433 = 0.731</li>
<li>Sunlamb: 1 + 0.088 - 0.350 = 0.738</li>
</ul></li>
<li><strong>Methylation Threshold:</strong> <span class="math inline">\(\theta_{\text{meth}} = V_{\text{cold, LV}}\)</span>
<ul>
<li>Emu_Rock: 0.731</li>
<li>Sunlamb: 0.738</li>
</ul></li>
<li><strong>Effective Duration of Vernalisation:</strong> <span class="math inline">\(H_{\text{vern, LV}} = \min(Ph_\text{vern}, Ph_\text{emergence} + VS_{LV})\)</span>
<ul>
<li>Emu_Rock: min(3.67, 2.52) = 2.52</li>
<li>Sunlamb: min(3.47, 3.57) = 3.47</li>
</ul></li>
<li><strong>Cold-Induced Vrn1 Expression Rate:</strong> <span class="math inline">\(\Delta V_{\text{cold, LV}} = (V_{\text{cold, LV}} + \theta_{\text{meth}}) / H_{\text{vern, LV}}\)</span>
<ul>
<li>Emu_Rock: (0.731 + 0.731) / 2.52 ≈ 1.462 / 2.52 ≈ 0.580</li>
<li>Sunlamb: (0.738 + 0.738) / 3.47 ≈ 1.476 / 3.47 ≈ 0.426</li>
</ul></li>
<li><strong>Max Cold-Induced Expression Rate at 0°C:</strong> <span class="math inline">\(\Delta V_{\text{cold, max}} = \Delta V_{\text{cold, LV}} / \exp(-0.17 \times 5.8)\)</span>
<ul>
<li>exp(-0.17 × 5.8) ≈ exp(-0.986) ≈ 0.373</li>
<li>Emu_Rock: 0.580 / 0.373 ≈ 1.555</li>
<li>Sunlamb: 0.426 / 0.373 ≈ 1.142</li>
</ul></li>
<li><strong>Cold-Induced Vrn1 Upregulation Factor:</strong> <span class="math inline">\(F_{\text{cold, vrn1}} = \Delta V_{\text{cold, max}} / \Delta V_{\text{base, veg}}\)</span>
<ul>
<li>Emu_Rock: 1.555 / 0.172 ≈ 9.04</li>
<li>Sunlamb: 1.142 / 0.098 ≈ 11.65</li>
</ul></li>
</ul>
<hr>
</section>
<section id="summary-table-of-estimated-parameters" class="level4">
<h4 class="anchored" data-anchor-id="summary-table-of-estimated-parameters"><strong>Summary Table of Estimated Parameters</strong></h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parameter</th>
<th>Emu_Rock</th>
<th>Sunlamb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BaseDVrnVeg</td>
<td>0.172</td>
<td>0.098</td>
</tr>
<tr class="even">
<td>MaxDVrnVeg</td>
<td>0.276</td>
<td>0.173</td>
</tr>
<tr class="odd">
<td>BaseDVrnER</td>
<td>0.333</td>
<td>0.333</td>
</tr>
<tr class="even">
<td>MaxDVrnER</td>
<td>0.333</td>
<td>0.333</td>
</tr>
<tr class="odd">
<td>PpVrn3FactVeg</td>
<td>1.000</td>
<td>1.000</td>
</tr>
<tr class="even">
<td>PpVrn3FactER</td>
<td>1.000</td>
<td>1.000</td>
</tr>
<tr class="odd">
<td>MaxVrn2</td>
<td>0.164</td>
<td>0.088</td>
</tr>
<tr class="even">
<td>MethalationThreshold</td>
<td>0.731</td>
<td>0.738</td>
</tr>
<tr class="odd">
<td>ColdVrn1Fact</td>
<td>9.04</td>
<td>11.65</td>
</tr>
</tbody>
</table>
<p><em>All values rounded to 3 decimal places.</em></p>
</section>
</section>
<section id="see-also" class="level2">
<h2 class="anchored" data-anchor-id="see-also">See Also</h2>
<ul>
<li><strong>Source code:</strong> <a href="http://github.com/APSIMInitiative/ApsimX/blob/master/Models/PMF/Phenology/CAMP/CalcCAMPVrnRates.cs" class="external-link">CalcCAMPVrnRates.cs on GitHub</a></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-brown_integration_2013" class="csl-entry" role="listitem">
Brown, Hamish E., Peter D. Jamieson, Ian R. Brooking, Derrick J. Moot, and Neil I. Huth. 2013. <span>“Integration of Molecular and Physiological Models to Explain Time of Anthesis in Wheat.”</span> <em>Annals of Botany</em> 112 (9): 1683–703. <a href="https://doi.org/10.1093/aob/mct224">https://doi.org/10.1093/aob/mct224</a>.
</div>
<div id="ref-celestina_cultivar_2023" class="csl-entry" role="listitem">
Celestina, Corinne, James Hunt, Haydn Kuchel, Felicity Harris, Kenton Porker, Ben Biddulph, Maxwell Bloomfield, et al. 2023. <span>“A Cultivar Phenology Classification Scheme for Wheat and Barley.”</span> <em>European Journal of Agronomy</em> 143 (February): 126732. <a href="https://doi.org/10.1016/j.eja.2022.126732">https://doi.org/10.1016/j.eja.2022.126732</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/apsimng-notes\.bangyou\.me");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../../../disclaimer.html">
<p>Disclaimer</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/byzheng/apsimng-notes/edit/main/docs/Models/PMF/Phenology/CAMP/CalcCAMPVrnRates.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/byzheng/apsimng-notes/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>