---
title: "PodInitiation"
format: html
---

The **PodInitiation** phase in [Chickpea](/docs/Plants/Chickpea) represents the developmental period from **EndFlowering** to **EndPodInitiation**. This phase marks when pods become visible (≥1 cm) and is uniquely determined by a temperature-day counting mechanism rather than traditional thermal time accumulation [@srinivasan_cold_1998; @clarke_response_2004].

## Overview

The [GenericPhase](/docs/Models/PMF/Phenology/Phases/GenericPhase.qmd) model simulates the time between **EndFlowering** and **EndPodInitiation** stages.

- This phase starts at **EndFlowering** and ends at **EndPodInitiation**
- The model uses a unique progression mechanism requiring 5 days of temp above 16 degrees (or ten days at 15 degrees) before 1cm pods are visible, due to sensitivity of pod initiation to mean daily temperature[@srinivasan_cold_1998; @clarke_response_2004]. These days may accumulate anytime after [start flowering](Flowering.qmd) (i.e. during previous growth phase as well as during the current phase).


## Temperature-Day Counting

Chickpea pod development shows strong sensitivity to mean daily temperature [@srinivasan_response_1998; @clarke_growth_2004]. Visible pods (1 cm) require specific temperature conditions before they become apparent at five days above 16°C or ten days above 15°C. These temperature days may accumulate during the flowering phase. 

Since the start flowering stage, the temperature-days are accumulated based on daily mean temperature ($T_{\text{mean}}$):

$$
TD = \begin{cases}
0 & \text{if } T_{\text{mean}} < 14°C \\
\frac{T_{\text{mean}} - 14}{2} & \text{if } 14°C \leq T_{\text{mean}} < 16°C \\
1 & \text{if } T_{\text{mean}} \geq 16°C
\end{cases}
$$

Where $TD$ represents the temperature-days accumulated for each day. For example:

- No accumulation when mean temperature is less than 14 °C
- 0.5 days when mean temperature is 15 °C
- 1 day when mean temperature is 16 °C or above


```{r fig-temperatur-day, fig.height=4, fig.cap="Temperature-day for pod initiation depending on daily mean temperature since start of flowering", echo=FALSE}
df <- data.frame(
    meant = c(13, 14, 16, 17),
    temperature_days = c(0, 0, 1, 1)
)

df |> 
    ggplot2::ggplot(ggplot2::aes(x = meant, y = temperature_days)) +
    ggplot2::geom_line() +
    ggplot2::geom_point() +
    ggplot2::labs(x = "Mean daily temperature (°C)", y = "Temperature days accumulated") +
    ggplot2::theme_minimal()
```


### Target Calculation

The target for pod initiation phase is calculated at the end flowering stage by subtracting the temperature-days accumulated during [flowering phase](Flowering.qmd) from the total required temperature-days for visible pods (i.e. 5 days):
$$
\text{Target} = 5.0 - TD_{\text{flowering}}
$$

Where:
- **5.0** = Total temperature-days required for 1 cm pods to be visible
- **TD_{\text{flowering}}** = Temperature-days accumulated from StartFlowering to EndFlowering (i.e. during the [flowering phase](Flowering.qmd))

This means if 2 temperature-days were accumulated during flowering, only 3 more are needed during the PodInitiation phase.

## Pod Initiation Process

The temperature days are continuously accumulated from the end flowering stage until the remaining target is reached. 

## Cultivar-Specific Parameters

| Name       | Description                                         | Default Value |
|------------|-----------------------------------------------------|---------------|
| [Phenology].PodInitiation.Target.Total | Total temperature-days required for visible pods | 5.0 |

Note: The actual target is dynamically calculated by subtracting `TD_{\text{flowering}}` from this total.
