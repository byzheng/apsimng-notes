---
title: "Frost and Heat Damage Functions"
output: html_document
---


A daily model that simulates yield reduction due to **frost and heat stresses**. Developed under the **GRDC Frost and Heat Management Analytics (FAHMA)** project for integration into APSIM Next Generation.


## Overview

The `FrostHeatDamageFunctions` model calculates **daily and cumulative yield reduction** based on:

- **Environmental severity** of frost and heat events using piecewise-linear temperature damage functions.
- **Crop sensitivity** at different **growth stages**, also represented by piecewise-linear functions.
- **Rainfall modification**, which optionally alters frost impact.

> **YieldReduction = PotentialDamage × Sensitivity**

The model is triggered daily and interacts with APSIM's `Phenology`, `Grain`, and `Weather` models.


## Model Usage

Place the `FrostHeatDamageFunctions` model **under a Plant model (e.g., Wheat, Canola, Barley)**.


## Configurable Properties

| Property                      | Type     | Description                                                                                             |
|------------------------------|----------|---------------------------------------------------------------------------------------------------------|
| `CropType`                   | Enum     | Crop species: `Wheat`, `Canola`, or `Barley`. Required to load default parameters.                      |
| `FrostLowTT`                 | double   | Lower temperature threshold for frost damage (°C).                                                      |
| `FrostUpTT`                  | double   | Upper temperature threshold for frost damage (°C).                                                      |
| `FrostMaxReductionRatio`     | double   | Maximum reduction ratio at the coldest temperature.                                                     |
| `FrostMinReductionRatio`     | double   | Minimum reduction ratio at the upper threshold.                                                         |
| `FrostStartSensitiveGS`      | double   | Start of the frost-sensitive growth period.                                                             |
| `FrostStartMostSensitiveGS`  | double   | Start of the most sensitive period to frost (sensitivity = 1).                                          |
| `FrostEndMostSensitiveGS`    | double   | End of the most sensitive period to frost.                                                              |
| `FrostEndSensitiveGS`        | double   | End of the frost-sensitive growth period.                                                               |
| `HeatLowTT`                  | double   | Lower temperature threshold for heat damage (°C).                                                       |
| `HeatUpTT`                   | double   | Upper temperature threshold for heat damage (°C).                                                       |
| `HeatMaxReductionRatio`      | double   | Maximum reduction ratio at hottest temperature.                                                         |
| `HeatMinReductionRatio`      | double   | Minimum reduction ratio at the lower threshold.                                                         |
| `HeatStartSensitiveGS`       | double   | Start of the heat-sensitive growth period.                                                              |
| `HeatStartMostSensitiveGS`   | double   | Start of the most sensitive period to heat (sensitivity = 1).                                           |
| `HeatEndMostSensitiveGS`     | double   | End of the most sensitive period to heat.                                                               |
| `HeatEndSensitiveGS`         | double   | End of the heat-sensitive growth period.                                                                |
| `RainfallEffect`             | double   | Modifier for frost damage when rain occurs (1 = no effect, >1 = increased damage, <1 = reduced).        |


## Outputs

The following variables are **reportable** in APSIM NG:

| Output                              | Description                                                                 |
|------------------------------------|-----------------------------------------------------------------------------|
| `FrostPotentialReductionRatio`     | Daily frost potential yield loss (0–1).                                     |
| `FrostSensitivity`                 | Sensitivity to frost based on growth stage (0–1).                           |
| `FrostReductionRatio`              | Daily yield loss from frost (actual).                                       |
| `HeatPotentialReductionRatio`      | Daily heat potential yield loss (0–1).                                      |
| `HeatSensitivity`                  | Sensitivity to heat based on growth stage (0–1).                            |
| `HeatReductionRatio`               | Daily yield loss from heat (actual).                                        |
| `FrostHeatReductionRatio`          | Combined daily loss from frost and heat.                                    |
| `CumulativeFrostReductionRatio`    | Cumulative yield loss from frost over the season.                           |
| `CumulativeHeatReductionRatio`     | Cumulative yield loss from heat over the season.                            |
| `CumulativeFrostHeatReductionRatio`| Total cumulative yield loss from frost and heat.                            |
| `FrostEventNumber`                 | Number of frost events during sensitive periods.                            |
| `HeatEventNumber`                  | Number of heat events during sensitive periods.                             |
| `FrostHeatYield`                   | Yield after accounting for frost and heat losses.                           |


## Events

| Event                     | Trigger | Description                                                                 |
|--------------------------|---------|-----------------------------------------------------------------------------|
| `Commencing`             | Start   | Validates that crop type is correctly selected and matches plant model.     |
| `Sowing`                 | Planting| Resets internal counters and output values.                                 |
| `DoManagementCalculations` | Daily | Computes frost/heat effects and yield reductions during plant growth.       |


## Notes

- Crop parameters are loaded automatically based on the selected `CropType`.
- Growth stage sensitivity functions are defined by 4 thresholds to describe increasing and decreasing sensitivity.
- The model uses:
  - `Weather.MinT` for frost detection
  - `Weather.MaxT` for heat detection
  - APSIM `Phenology.Stage` for current crop development
- If rainfall on the **previous day** is between 1–10 mm, an alternate frost response curve is used.


## Supported Crops

- **Wheat** and **Canola** have fully parameterized frost/heat damage models.
- **Barley** is included but parameters may still be under evaluation.
